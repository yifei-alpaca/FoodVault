<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<meta content="width=device-width, initial-scale=1.0" name="viewport" />

		<title>Food Vault - Recipes Generator</title>
		<meta content="" name="description" />
		<meta content="" name="keywords" />

		<script src="https://unpkg.com/axios/dist/axios.min.js"></script>

		<!-- Favicons -->
		<link href="./assets/img/Logo/bar-icon.jpg" sizes="32x32" rel="icon" />

		<!-- Google Fonts -->
		<link
			href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Raleway:300,300i,400,400i,500,500i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i"
			rel="stylesheet"
		/>

		<!-- Vendor CSS Files -->
		<link href="assets/vendor/aos/aos.css" rel="stylesheet" />
		<link
			href="assets/vendor/bootstrap/css/bootstrap.min.css"
			rel="stylesheet"
		/>
		<link
			href="assets/vendor/bootstrap-icons/bootstrap-icons.css"
			rel="stylesheet"
		/>
		<link href="assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet" />
		<link
			href="assets/vendor/glightbox/css/glightbox.min.css"
			rel="stylesheet"
		/>
		<link href="assets/vendor/remixicon/remixicon.css" rel="stylesheet" />
		<link href="assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet" />

     
		<!-- Template Main CSS File -->
        <link href="assets/css/recipe.css" rel="stylesheet" />
        <style>
          .card , .card-body{
              height:100%;
          }
    
          .card-img-top{
            height:250px;
          }

          @media (max-width: 667px) {
                 h2 {
                    /* max-width: 100%; */
                    font-size: 20px !important;
                }
            }
    

            .div{
                display: flex;
            }

            .dropzone-wrapper {
                margin: 25px auto;
                width:90%;
            }

            .dropzone {
                overflow: hidden;
                margin:auto;
                width: 100%;
                height: auto;
                color: #3498db;
                text-align: center;
                background: #fff;
                line-height: fit-content;
                min-height:200px;
                border: 2px dashed transparent;
                border-color: #3498db;
                transition: background .15s linear, border-color .15s linear;
            
            }

            #dropzone1{
                width: 100%;
                height:fit-content;
                word-wrap: break-word;
                line-height: fit-content;
            }

            .dropzone.-drop-possible {
            border-color: #3498db;
            }

            .dropzone.-drop-over {
                background: #77bef0;
                color: #fff;
            }


            .draggable-food {
                position: relative;
                z-index: 10;
                width: 10%;
                margin:auto;
                height: auto;
                line-height: 150px;
                color: #fff;
                text-align: center;
                border-radius: 100%;
                -ms-touch-action: none;
                    touch-action: none;
            }


            #f{
                border:2px solid rgb(89, 139, 248);
                padding: 5px;
            }



        </style>
</head>
<body>
     <!-- ======= Header ======= -->
		<header id="header" class="fixed-top d-flex align-items-center">
			<div class="container d-flex align-items-center justify-content-between">
				<div class="logo">
					<h1><a href="./index.html">Food Vault</a></h1>
				</div>
				<nav id="navbar" class="navbar">
					<ul>
						<li>
							<a class="nav-link" href="./index.html">Home</a>
						</li>
						<li><a class="nav-link " href="./index.html#about">About</a></li>
						<!-- <li><a class="nav-link scrollto" href="#services"></a></li> -->
						<li><a class="nav-link" href="./index.html#team">Team</a></li>
						<li><a class="nav-link " href="./index.html#faq">FAQ</a></li>
						<li class="nav-item dropdown">
							<a
								class="nav-link active dropdown-toggle"
								href="#services"
								id="navbarDropdownMenuLink"
								role="button"
								data-bs-toggle="dropdown"
								aria-expanded="false"
							>
								Services
							</a>
							<ul
								class="dropdown-menu"
								aria-labelledby="navbarDropdownMenuLink"
							>
								<li><a class="dropdown-item" href="./learn.html">Learn</a></li>
								<li>
									<a class="dropdown-item" href="./games_page.html">Games</a>
								</li>
								<li>
									<a class="dropdown-item" href="./recipe_generator.html"
										>Recipe Generator</a
									>
								</li>
								<li>
									<a class="dropdown-item" href="./main_merchants.html"
										>List of Merchants</a
									>
								</li>
							</ul>
						</li>
						<li><a class="nav-link" href="signup.html">Sign Up</a></li>
						<li><a class="nav-link" href="signin.html">Sign In</a></li>
					</ul>
					<i class="bi bi-list mobile-nav-toggle"></i>
				</nav>
				<!-- .navbar -->
			</div>
		</header>
		<!-- End Header -->


    <section id="services" class="d-flex align-items-center" style="height: fit-content;">
     
       
        <div class="container mt-5 pt-3" data-aos="fade-up"
        data-aos-delay="400">

        <div class="section-title" data-aos="fade-up">
            <h2>Recipe Generator</h2>  
        </div>
       

            <div class="section-title" style="width:85%; margin:auto;"       >
                <div class="container mb-0 pb-0">
				</div>
                <p style="margin-top:0px; margin-bottom: 0px;">Try out our recipe generator! You can either add your leftover food yourself, click and drag the common food waste item found in household, or a combination of both! Click generate when you are ready or click reset to remove all!</p>
            </div>
        <div class=" py-2 m-1">
           
          
            <div class="dropzone-wrapper">
               
                  
            
                <div id="parentfood">
                    <div style="width:50%;"  class="input-group mb-2">
                        <input type="text" id="foodinput" class="form-control" placeholder="Ingredient" aria-label="Recipient's username" aria-describedby="button-addon2">
                        <button class="btn btn-outline-primary" type="button" id="button-addon2" onclick="add()">Add</button>
                      </div>
                  
                        
                       
                <div id="f" class="mt-2">
                   
                    <div class="div">
                    <img class="draggable-food js-drag drag1"   src="assets/img/food/brocolli.png" alt="broccoli" width="100" height="100">
                    <img class="draggable-food js-drag drag1"   src="assets/img/food/carrot.png" alt="carrot" width="100" height="100">
                    <img class="draggable-food js-drag drag1"   src="assets/img/food/apple.png" alt="apple" width="100" height="100">
                    <img class="draggable-food js-drag drag1"   src="assets/img/food/bread.png" alt="bread" width="100" height="100">
                    <img class="draggable-food js-drag drag1"   src="assets/img/food/cabbage.png" alt="cabbage" width="100" height="100">
                    <img class="draggable-food js-drag drag1"   src="assets/img/food/corn.png" alt="corn" width="100" height="100">
                    <img class="draggable-food js-drag drag1"   src="assets/img/food/cucumber.png" alt="cucumber" width="100" height="100">
                    <img class="draggable-food js-drag drag1"   src="assets/img/food/potato.png" alt="potato" width="100" height="100">
                    <img class="draggable-food js-drag drag1"   src="assets/img/food/mushroom.png" alt="mushroom" width="100" height="100">
                </div> </div>

            </div>
                <div id="dropzone1" class="dropzone mt-3 pt-2">Ingredients Basket : 
                    
                </div>

                <div class="mt-3"> <button type="button" class="btn btn-outline-primary" onclick="generate()">Generate Recipe</button>
                    <button type="button" class="btn btn-outline-primary" onclick="reset()">Reset</button>
                  
                
                </div>
                <div class="row row-cols-1 row-cols-sm-2 row-cols-lg-4 g-2 m-auto" style="width:100%" id="recipes"></div>
            </div>
            </div>
            
        </div>


    
      </div>
    </section>


  

                          
           

                
    </div>

    <br><br><br><br><br>

    <!-- End First Section -->
    <main id="main">
        <!-- ======= Special Thanks and Footer Section ======= -->
        <section id="clients" class="clients clients">
            <div class="container">
                <br />
                <h3>Special Thanks to :</h3>
                <div class="row my-4">
                    <div class="col-lg-4 col-md-4 col-4">
                        <img
                            style="height: auto"
                            title="SMU"
                            src="assets/img/footer/SMU.png"
                            class="img-fluid"
                            alt=""
                            data-aos="zoom-in"
                        />
                    </div>
                    <div class="col-lg-4 my-auto col-md-4 col-4">
                        <img
                            src="assets/img/footer/SCIS.png"
                            class="img-fluid"
                            alt=""
                            data-aos="zoom-in"
                            data-aos-delay="300"
                        />
                    </div>

                    <div class="col-lg-4 my-auto col-md-4 col-4">
                        <img
                            src="assets/img/footer/prof.png"
                            class="img-fluid"
                            alt=""
                            data-aos="zoom-in"
                            data-aos-delay="100"
                        />
                    </div>
                </div>
            </div>
            <br />
            &copy; Copyright <strong>Food Vault </strong>. All Rights Reserved
            <br />
            <br />
        </section>
        <!-- Special Thanks and Footer Section -->
    </main>
    <!-- End #main -->
    <a
        href="#"
        class="back-to-top d-flex align-items-center justify-content-center"
        ><i class="bi bi-arrow-up-short"></i
    ></a>

  
    <script src='https://cdnjs.cloudflare.com/ajax/libs/interact.js/1.2.6/interact.min.js'></script>
    
<script>




    var list_of_food = [];
   
    function reset(){
        var recipe_container = document.getElementById("recipes");
    var str = "";
    recipe_container.innerHTML=str;
        var d = document.getElementById("parentfood");
        var a = document.getElementById("f");
        var original_a =`                 
        <div class="div">
            <img class="draggable-food js-drag drag1"   src="assets/img/food/brocolli.png" alt="broccoli" width="100" height="100">
                    <img class="draggable-food js-drag drag1"   src="assets/img/food/carrot.png" alt="carrot" width="100" height="100">
                    <img class="draggable-food js-drag drag1"   src="assets/img/food/apple.png" alt="apple" width="100" height="100">
                    <img class="draggable-food js-drag drag1"   src="assets/img/food/bread.png" alt="bread" width="100" height="100">
                    <img class="draggable-food js-drag drag1"   src="assets/img/food/cabbage.png" alt="cabbage" width="100" height="100">
                    <img class="draggable-food js-drag drag1"   src="assets/img/food/corn.png" alt="corn" width="100" height="100">
                    <img class="draggable-food js-drag drag1"   src="assets/img/food/cucumber.png" alt="cucumber" width="100" height="100">
                    <img class="draggable-food js-drag drag1"   src="assets/img/food/potato.png" alt="potato" width="100" height="100">
                    <img class="draggable-food js-drag drag1"   src="assets/img/food/mushroom.png" alt="mushroom" width="100" height="100">
                </div>
        
        `; 
       
        a.remove();
        var b = document.createElement("div");
        b.setAttribute("id","f");
        b.innerHTML = original_a;
        d.appendChild(b);
        list_of_food = [];
        var dropzone = document.getElementById("dropzone1");
dropzone.textContent = "Ingredients Basket : ";
       
    }

    function generate(){
        if (list_of_food.length==0){
            alert("Please select some ingredient first!")
        }
        else{
            generateRecipe(list_of_food);
        }
    }
    



    (function (interact) {
    'use strict';
    var transformProp;

    interact.maxInteractions(Infinity);

    // setup draggable elements.
    interact('.js-drag')
        .draggable({ max: Infinity })
        .on('dragstart', function (event) {
            event.interaction.x = parseInt(event.target.getAttribute('data-x'), 10) || 0;
            event.interaction.y = parseInt(event.target.getAttribute('data-y'), 10) || 0;
        })
        .on('dragmove', function (event) {
            event.interaction.x += event.dx;
            event.interaction.y += event.dy;

            if (transformProp) {
                event.target.style[transformProp] =
                    'translate(' + event.interaction.x + 'px, ' + event.interaction.y + 'px)';
            }
            else {
                event.target.style.left = event.interaction.x + 'px';
                event.target.style.top  = event.interaction.y + 'px';
            }
        })
        .on('dragend', function (event) {
            event.target.setAttribute('data-x', event.interaction.x);
            event.target.setAttribute('data-y', event.interaction.y);
        });

    // setup drop areas.
    // dropzone #1 accepts draggable #1
    setupDropzone('#dropzone1', '.drag1');

    /**
     * Setup a given element as a dropzone.
     *
     * @param {HTMLElement|String} el
     * @param {String} accept
     */
    function setupDropzone(el, accept) {
        interact(el)
            .dropzone({
                accept: accept,
                ondropactivate: function (event) {
                    addClass(event.relatedTarget, '-drop-possible');
                },
                ondropdeactivate: function (event) {
                    removeClass(event.relatedTarget, '-drop-possible');
                }
            })
            .on('dropactivate', function (event) {
                var active = event.target.getAttribute('active')|0;

                // change style if it was previously not active
                if (active === 0) {
                    addClass(event.target, '-drop-possible');
                    event.target.textContent = 'Drop me here!';
                }

                event.target.setAttribute('active', active + 1);
            })
            .on('dropdeactivate', function (event) {
                var active = event.target.getAttribute('active')|0;

                // change style if it was previously active
                // but will no longer be active
                if (active === 1) {
                    removeClass(event.target, '-drop-possible');
                    event.target.textContent = 'Ingredients Basket : '+ list_of_food;
                }

                event.target.setAttribute('active', active - 1);
            })
            .on('dragenter', function (event) {
                addClass(event.target, '-drop-over');
                event.relatedTarget.textContent = 'I\'m in';
            })
            .on('dragleave', function (event) {
                removeClass(event.target, '-drop-over');
                event.relatedTarget.textContent = 'Drag me…';
                list_of_food = list_of_food.filter(e => e !== event.relatedTarget.alt); 
                var dropzone = document.getElementById("dropzone1");
dropzone.textContent = "Ingredients Basket : " + list_of_food;
                
            })
            .on('drop', function (event) {
                removeClass(event.target, '-drop-over');
                list_of_food = list_of_food.filter(e => e !== event.relatedTarget.alt); 
                list_of_food.push(event.relatedTarget.alt);
             
                var dropzone = document.getElementById("dropzone1");
dropzone.textContent ="Ingredients Basket : "  + list_of_food;
                event.relatedTarget.textContent = 'Dropped';   
            });
    }

    function addClass (element, className) {
        if (element.classList) {
            return element.classList.add(className);
        }
        else {
            element.className += ' ' + className;
        }
    }

    function removeClass (element, className) {
        if (element.classList) {
            return element.classList.remove(className);
        }
        else {
            element.className = element.className.replace(new RegExp(className + ' *', 'g'), '');
        }
    }

    interact(document).on('ready', function () {
        transformProp = 'transform' in document.body.style
            ? 'transform': 'webkitTransform' in document.body.style
            ? 'webkitTransform': 'mozTransform' in document.body.style
            ? 'mozTransform': 'oTransform' in document.body.style
            ? 'oTransform': 'msTransform' in document.body.style
            ? 'msTransform': null;
    });

}(window.interact));

function add(){
var a = document.getElementById("foodinput").value;
a = a.toLowerCase();

if(a.length==0){
    alert("Enter something!");
}
else{
    document.getElementById("foodinput").value="";
var dropzone = document.getElementById("dropzone1");
list_of_food = list_of_food.filter(e => e !== a); 
list_of_food.push(a);
dropzone.textContent = "Ingredients Basket : " + list_of_food;
}
}


</script>  



<script>

    function generateRecipe(ingredient){

    ingredient = ingredient.toString();
  
    var key = "daeb006481e240f4b2d4cff4bbbfcf8e";
    var url = "https://api.spoonacular.com/recipes/findByIngredients";
    axios
      .get(url, {
        params: {
          apiKey: key,
          ingredients: ingredient,
          number: 10,
          ranking: 1,
        },
      })
      .then((response) => {
        generateToDiv(response.data);
      })
      .catch((error) => {
        console.log(error);
        // process error object
      });  }
  </script>

  <script>

    function generateToDiv(res){
    
  
    var recipe_container = document.getElementById("recipes");
    var str = "";

    if (res.length==0){
        str = `<p class="text-danger"> No recipes found :( </p>`;
    }
    else{


    for (recipe of res) {
      
      str += `          <div class="col">
                              <div class="card"> 
                                <div class="icon-box" data-aos="fade-up" data-aos-delay="100">
          <img class="card-img-top"  src="${recipe.image}" alt="" srcset="">
          <div class="card-body">
                                    <h5 class="card-title"><a href="">${recipe.title}</a></h5>
                                    <p class="card-text" style="margin-bottom:20%;">`;


      var missing = recipe.missedIngredientCount;
      if (missing == 0) {
        str += `That's all you need to cook! Have a good meal `;
      } else {
        str += `You will also need `;

        for (i=0; i < missing ; i++) {
          if(missing ==1){
            str+=`${recipe.missedIngredients[i].name} `;
          }

          else if(i+1==missing){
            str+=`and ${recipe.missedIngredients[i].name}`;
          }

          else{
            str+=`${recipe.missedIngredients[i].name}, `;
          }
         
        }
      }

      str += ` .</p>   
   

                         </div>
                         </div>           <div class="px-3" style="position:absolute; bottom:10px;" >
                          <button class="btn btn-outline-primary flex-shrink-0" type="button" onclick="direct(${recipe.id})"
                                                 >Read More
                                                  </button>
  </div></div>
              
                   </div>`;
    }
      
}
                      

    recipe_container.innerHTML = str;  }
  </script>

  <script>
      function direct(id){
        var key = "daeb006481e240f4b2d4cff4bbbfcf8e";
    var url = "https://api.spoonacular.com/recipes/"+id+"/information";
    axios
      .get(url, {
        params: {
          apiKey: key,
          includeNutrition: false,
        },
      })

      .then((response) => {
        window.open(response.data.sourceUrl, '_blank').focus();
  
      })
      .catch((error) => {
        console.log(error);
        // process error object
      });  
      }

  </script>


<script src="assets/vendor/aos/aos.js"></script>
<script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
<script src="assets/vendor/glightbox/js/glightbox.min.js"></script>
<script src="assets/vendor/isotope-layout/isotope.pkgd.min.js"></script>
<script src="assets/vendor/purecounter/purecounter.js"></script>
<script src="assets/vendor/swiper/swiper-bundle.min.js"></script>

<!-- Template Main JS File -->
<script src="assets/js/main.js"></script>
</body>
  </html>
  