<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />

    <title>Food Vault - Sign up</title>
    <meta content="" name="description" />
    <meta content="" name="keywords" />

    <script src="https://unpkg.com/bcryptjs@2.4.3/dist/bcrypt.js"></script>

    <!-- add this-->
    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <script
      type="module"
      src="https://www.gstatic.com/firebasejs/9.1.2/firebase-app.js"
    ></script>
    <!-- This is the API from Firebase Realtime Database -->
    <script
      type="module"
      src="https://www.gstatic.com/firebasejs/9.1.2/firebase-database.js"
    ></script>

    <!-- Favicons -->
    <link href="./assets/img/Logo/bar-icon.jpg" sizes="32x32" rel="icon" />

    <!-- Axios-->
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>

    <!-- Google Fonts -->
    <link
      href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Raleway:300,300i,400,400i,500,500i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i"
      rel="stylesheet"
    />

    <!-- Font Awesome -->
    <link
      rel="stylesheet"
      href="https://use.fontawesome.com/releases/v5.15.4/css/all.css"
      integrity="sha384-DyZ88mC6Up2uqS4h/KRgHuoeGwBcD4Ng9SiP4dIRy0EXTlnuz47vAwmeGwVChigm"
      crossorigin="anonymous"
    />

    <!-- Vendor CSS Files -->
    <link href="assets/vendor/aos/aos.css" rel="stylesheet" />
    <link
      href="assets/vendor/bootstrap/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="assets/vendor/bootstrap-icons/bootstrap-icons.css"
      rel="stylesheet"
    />
    <link href="assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet" />
    <link
      href="assets/vendor/glightbox/css/glightbox.min.css"
      rel="stylesheet"
    />
    <link href="assets/vendor/remixicon/remixicon.css" rel="stylesheet" />
    <link href="assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet" />

    <!-- Template Main CSS File -->
    <link href="assets/css/style.css" rel="stylesheet" />
    <style>
      .icon,
      .icon2 {
        font-size: 2rem;
      }

      input {
        font: inherit;
        outline: 0;
      }

      .mt-2 {
        font-size: 30px;
      }

      .form__input {
        border-radius: 0.25em;
        border-style: solid;
        width: 70%;
        padding: 0.5em 4em 0.5em 1em;
      }

      #formFileSm {
        border-style: solid;
        border-radius: 0.25em;
        border-style: solid;
        width: 70%;
      }

      .search_input {
        border-radius: 0.25em;
        border-style: solid;
        width: 70%;
        padding: 0.5em 4em 0.5em 1em;
      }

      .list,
      .add,
      .des {
        border-radius: 0.25em;
        border-style: solid;
        width: 70%;
        padding: 0.5em 0.5em 0.5em 1em;
        line-height: 25px;
      }
      .form__input2 {
        /* border-color: firebrick; */
        border-radius: 0.25em;
        border-style: solid;
        padding: 0.5em 4em 0.5em 1em;
        width: 70%;
      }
      .form__input:valid {
        border-color: forestgreen;
      }

      .form__input:valid + .icon::after {
        content: "";
      }

      .form__input:invalid {
        /* border-color: firebrick; */
      }

      .form__input:invalid + .icon::after {
        content: "";
      }

      form {
        height: fit-content;
        width: 50%;
        background-color: #f8f8f8;
        padding-left: 5em;
      }

      .eyeslash {
        position: relative;
        right: 30px;
        display: inline;
      }

      .eye {
        position: relative;
        right: 30px;
        display: none;
      }

      @media screen and (max-width: 900px) {
        .mt-2 {
          font-size: 20px;
        }

        h5 {
          font-size: 15px;
        }

        input {
          width: 70%;
        }

        form {
          width: 60%;
          /* padding-left: 3em; */
        }
      }

      @media screen and (max-width: 700px) {
        .mt-2 {
          font-size: 18px;
        }

        h5 {
          font-size: 14px;
        }

        input {
          width: 70%;
        }

        small {
          font-size: 12px;
        }

        form {
          width: 70%;
          padding-left: 2em;
        }
      }

      /* @media screen and (max-width: 400px) {
            	input {
                	width: 60% !important;
            	}
        	}

        	@media screen and (max-width: 330px) {
            h1{
              font-size: 25px !important;
            }

            h5{
              font-size: 13px;
            }
            .mt-2 {
              font-size: 18px;
            }

            form {
					    width: fit-content !important
				    }

            input {
              width: 70% !important
            }

            .eyeslash{
              position: relative;
              right: -110px;
              top: -35px;
              display: inline
            }

            .eye{
              position: relative;
              right: -110px;
              top: -35px;
              display: none
            }
        	} */

      @media screen and (max-width: 500px) {
        form {
          width: 100%;
          padding-left: 1em;
        }
      }
    </style>
  </head>

  <body>
    <!-- ======= Header ======= -->
    <header id="header" class="fixed-top d-flex align-items-center">
      <div class="container d-flex align-items-center justify-content-between">
        <div class="logo">
          <h1><a href="./index.html">Food Vault</a></h1>
          <!-- Uncomment below if you prefer to use an image logo -->
          <!-- <a href="index.html"><img src="assets/img/logo.png" alt="" class="img-fluid"></a>-->
        </div>
        <nav id="navbar" class="navbar">
          <ul>
            <li>
              <a class="nav-link scrollto" href="./index.html#app">Home</a>
            </li>
            <li>
              <a class="nav-link scrollto" href="./index.html#about">About</a>
            </li>
            <!-- <li><a class="nav-link scrollto" href="#services"></a></li> -->
            <li>
              <a class="nav-link scrollto" href="./index.html#team">Team</a>
            </li>
            <li>
              <a class="nav-link scrollto" href="./index.html#faq">FAQ</a>
            </li>
            <li class="nav-item dropdown">
              <a
                class="nav-link scrollto dropdown-toggle"
                href="#services"
                id="navbarDropdownMenuLink"
                role="button"
                data-bs-toggle="dropdown"
                aria-expanded="false"
              >
                Services
              </a>
              <ul
                class="dropdown-menu"
                aria-labelledby="navbarDropdownMenuLink"
              >
                <li><a class="dropdown-item" href="./learn.html">Learn</a></li>
                <li>
                  <a class="dropdown-item" href="./games_page.html">Games</a>
                </li>
                <li>
                  <a class="dropdown-item" href="./recipe_generator.html"
                    >Recipe Generator</a
                  >
                </li>
                <li>
                  <a class="dropdown-item" href="./main_merchants.html"
                    >List of Merchants</a
                  >
                </li>
              </ul>
            </li>
            <li><a class="nav-link active" href="signup.html">Sign Up</a></li>
            <li><a class="nav-link" href="signin.html">Sign In</a></li>
          </ul>
          <i class="bi bi-list mobile-nav-toggle"></i>
        </nav>
        <!-- .navbar -->
      </div>
    </header>
    <!-- End Header -->

    <!-- ======= First Section ======= -->
    <section
      id="sign_up"
      class="d-flex align-items-center"
      style="height: fit-content; margin-top: 5%"
    >
      <div class="container-fluid">
        <form class="border py-5 m-auto">
          <h1 class="mt-2">Register with Food Vault</h1>
          <br />
          <label for="sp"><h5>Search for your business :</h5></label>
          <div class="form__field">
            <input
              type="text"
              list="shop"
              id="sp"
              class="list"
              oninput="fill()"
              onchange="populate(this)"
            />
            <datalist id="shop"> </datalist>
            <span class="icon"></span>
            <p class="mt-1" id="" style="font-size: 12px">
              Select your business from the dropdown list
            </p>
          </div>

          <h5>Business Address :</h5>
          <div class="form__field">
            <input type="text" id="add" class="add" disabled />

            <p class="mt-1" id="" style="font-size: 12px">
              This will be automatically entered by our system
            </p>
          </div>

          <label for="des"><h5>Short description of your business :</h5></label>
          <div class="form__field">
            <input type="text" id="des" class="des" maxlength="120" />

            <p class="mt-1" id="" style="font-size: 12px">
              Enter a short description of your business!
            </p>
          </div>

          <div class="mb-0">
            <label for="formFileSm"
              ><h5>Attach an image url of your business :</h5></label
            >
            <input type="text" id="formFileSm" id="im" class="des" />
          </div>
          <p class="mt-1" id="" style="font-size: 12px">
            Rectangle image preferred (1000x667 or similar ratios)
          </p>

          <label for="use_input"><h5>Enter your Username</h5></label>
          <div class="form__field">
            <input
              id="use_input"
              type="text"
              class="form__input"
              pattern=".{6,}"
              required
              oninput="user();"
            />
            <span class="icon"></span>
            <p class="mt-1" id="use_warning" style="font-size: 12px">
              User must contain at least 6 letters
            </p>
          </div>

          <label for="pw"><h5>Enter your password</h5></label>
          <div class="form__field">
            <input
              id="pw"
              type="password"
              class="form__input"
              oninput="callboth()"
              pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,}"
              required
            />
            <span class="icon"></span>
            <span class="eyeslash" onclick="toggle()">
              <i class="far fa-eye-slash" aria-hidden="true"></i>
            </span>
            <span class="eye" onclick="toggle()">
              <i class="far fa-eye" aria-hidden="true"></i>
            </span>
            <p class="mt-1" id="hint" style="font-size: 12px">
              Password must contain at least : 8 characters,1 number,an upper
              case letter,a lower case letter
            </p>
          </div>

          <label for="pw2"><h5>Re-Enter your password</h5></label>
          <div class="form__field2">
            <input
              id="pw2"
              type="password"
              class="form__input2"
              oninput="callboth()"
              required
            />
            <span class="icon2"></span>
            <span class="eyeslash" onclick="toggleRe()">
              <i class="far fa-eye-slash" aria-hidden="true"></i>
            </span>
            <span class="eye" onclick="toggleRe()">
              <i class="far fa-eye" aria-hidden="true"></i>
            </span>
            <p class="mt-1" id="check1" style="font-size: 12px">
              Password must match
            </p>
          </div>
          <button
            type="button"
            onclick="validate()"
            class="btn btn-outline-primary"
          >
            Register
          </button>
          <p
            id="text"
            class="mt-2 p-0 mb-0"
            style="visibility: hidden; color: red; font-size: 14px"
          >
            Please ensure your details are entered correctly
          </p>
        </form>
      </div>
    </section>

    <!-- End First Section -->
    <main id="main">
      <!-- ======= Special Thanks and Footer Section ======= -->
      <section id="clients" class="clients clients">
        <div class="container">
          <br />
          <h3>Special Thanks to :</h3>
          <div class="row my-4">
            <div class="col-lg-4 col-md-4 col-4">
              <img
                style="height: auto"
                title="SMU"
                src="assets/img/footer/SMU.png"
                class="img-fluid"
                alt=""
                data-aos="zoom-in"
              />
            </div>
            <div class="col-lg-4 my-auto col-md-4 col-4">
              <img
                src="assets/img/footer/SCIS.png"
                class="img-fluid"
                alt=""
                data-aos="zoom-in"
                data-aos-delay="300"
              />
            </div>

            <div class="col-lg-4 my-auto col-md-4 col-4">
              <img
                src="assets/img/footer/prof.png"
                class="img-fluid"
                alt=""
                data-aos="zoom-in"
                data-aos-delay="100"
              />
            </div>
          </div>
        </div>
        <br />
        &copy; Copyright <strong>Food Vault </strong>. All Rights Reserved
        <br />
        <br />
      </section>
      <!-- Special Thanks and Footer Section -->
    </main>
    <!-- End #main -->

    <a
      href="#"
      class="back-to-top d-flex align-items-center justify-content-center"
      ><i class="bi bi-arrow-up-short"></i
    ></a>

    <!-- Vendor JS Files -->
    <script src="assets/vendor/aos/aos.js"></script>
    <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="assets/vendor/glightbox/js/glightbox.min.js"></script>
    <script src="assets/vendor/isotope-layout/isotope.pkgd.min.js"></script>
    <script src="assets/vendor/purecounter/purecounter.js"></script>
    <script src="assets/vendor/swiper/swiper-bundle.min.js"></script>

    <!-- Template Main JS File -->
    <script src="assets/js/main.js"></script>

    <!-- Toggle password -->
    <script>
      var state = false;
      function toggle() {
        var pw = document.getElementById("pw");
        var eye = document.getElementsByClassName("eye")[0];
        var eyeslash = document.getElementsByClassName("eyeslash")[0];
        if (state) {
          pw.setAttribute("type", "password");
          eye.style.display = "none";
          eyeslash.style.display = "inline";
          state = false;
        } else {
          pw.setAttribute("type", "text");
          eye.style.display = "inline";
          eyeslash.style.display = "none";
          state = true;
        }
      }

      // Toggle Reenter password
      function toggleRe() {
        var pw2 = document.getElementById("pw2");
        var eye = document.getElementsByClassName("eye")[1];
        var eyeslash = document.getElementsByClassName("eyeslash")[1];
        if (state) {
          pw2.setAttribute("type", "password");
          eye.style.display = "none";
          eyeslash.style.display = "inline";
          state = false;
        } else {
          pw2.setAttribute("type", "text");
          eye.style.display = "inline";
          eyeslash.style.display = "none";
          state = true;
        }
      }
    </script>

    <script type="module">
      //firebase config
      import { initializeApp } from "https://www.gstatic.com/firebasejs/9.1.2/firebase-app.js";
      import {
        getDatabase,
        ref,
        set,
        get,
        child,
      } from " https://www.gstatic.com/firebasejs/9.1.2/firebase-database.js";
      import { getStorage } from " https://www.gstatic.com/firebasejs/9.1.3/firebase-storage.js";
      function _0x61b0(_0x32f017, _0x1796dc) {
        const _0x5438e6 = _0x5438();
        return (
          (_0x61b0 = function (_0x61b0ef, _0x4f7bcd) {
            _0x61b0ef = _0x61b0ef - 0x76;
            let _0x7e35a6 = _0x5438e6[_0x61b0ef];
            return _0x7e35a6;
          }),
          _0x61b0(_0x32f017, _0x1796dc)
        );
      }
      function _0x5438() {
        const _0x1c235b = [
          "foodvault-6d35a.appspot.com",
          "1:863157964884:web:02b343ccf7a6d780459dc1",
          "29358EXhvKR",
          "4759479MdxeZB",
          "32760nOCBqS",
          "20132JIWDPc",
          "789702mIGKjv",
          "275jGcgrV",
          "142828yOMZSz",
          "G-S687X22CVW",
          "863157964884",
          "AIzaSyDKC3yvnonrxiGALVjDktGoS_t8y5adUJk",
          "142828GvgPjR",
          "114RyXPVX",
          "https://foodvault-6d35a-default-rtdb.asia-southeast1.firebasedatabase.app",
        ];
        _0x5438 = function () {
          return _0x1c235b;
        };
        return _0x5438();
      }
      const _0x3bbf34 = _0x61b0;
      (function (_0x124837, _0x42ad76) {
        const _0x1311d8 = _0x61b0,
          _0x4b4194 = _0x124837();
        while (!![]) {
          try {
            const _0x5c1918 =
              parseInt(_0x1311d8(0x80)) / 0x1 +
              parseInt(_0x1311d8(0x7b)) / 0x2 +
              parseInt(_0x1311d8(0x84)) / 0x3 +
              (-parseInt(_0x1311d8(0x83)) / 0x4) *
                (parseInt(_0x1311d8(0x76)) / 0x5) +
              (-parseInt(_0x1311d8(0x7c)) / 0x6) *
                (parseInt(_0x1311d8(0x77)) / 0x7) +
              parseInt(_0x1311d8(0x82)) / 0x8 +
              parseInt(_0x1311d8(0x81)) / 0x9;
            if (_0x5c1918 === _0x42ad76) break;
            else _0x4b4194["push"](_0x4b4194["shift"]());
          } catch (_0x11133e) {
            _0x4b4194["push"](_0x4b4194["shift"]());
          }
        }
      })(_0x5438, 0x38bf9);
      const firebaseConfig = {
        apiKey: _0x3bbf34(0x7a),
        authDomain: "foodvault-6d35a.firebaseapp.com",
        databaseURL: _0x3bbf34(0x7d),
        projectId: "foodvault-6d35a",
        storageBucket: _0x3bbf34(0x7e),
        messagingSenderId: _0x3bbf34(0x79),
        appId: _0x3bbf34(0x7f),
        measurementId: _0x3bbf34(0x78),
      };

      const app = initializeApp(firebaseConfig);
      const database = getDatabase(app);

      function escape(htmlStr) {
        // console.log(htmlStr);
        return htmlStr
          .replace(/&/g, "ysand")
          .replace(/</g, "yslt")
          .replace(/>/g, "ysgt")
          .replace(/"/g, "ysquot")
          .replace(/'/g, "ys39")
          .replace(/#/g, "yshash")
          .replace(new RegExp("\\$", "g"), "ysdollar")
          .replace(new RegExp("\\[", "g"), "ysleft")
          .replace(new RegExp("\\]", "g"), "ysright")
          .replace(new RegExp("\\.", "g"), "ysdot")
          .replace(new RegExp("\\/", "g"), "ysslsh");
      }

      function writeUserData() {
        var des = document.getElementById("des").value;
        var shopname = document.getElementsByClassName("list")[0].value;
        var address = document.getElementById("add").value;
        var user = document.getElementById("use_input").value;
        var p = document.getElementById("pw").value;
        var bcrypt = dcodeIO.bcrypt;
        var salt = bcrypt.genSaltSync(10);
        var hash = bcrypt.hashSync(p, salt);
        shopname = escape(shopname);
        address = escape(address);
        user = escape(user);
        des = escape(des);
        var img = document.getElementById("formFileSm").value;
        img = escape(img);

        const db = getDatabase();
        set(ref(db, "merchants/" + shopname), {
          merchant: shopname,
          address: address,
          description: des,
          username: user,
          password: hash,
          imageurl: img,
        });

        set(ref(db, "credentials/" + user), {
          username: user,
          password: hash,
          merchant: shopname,
        });
        var p = document.getElementById("text");
        p.innerText = "Success!";
        window.location.replace("./signin.html");
      }

      function checkDuplicate() {
        var user = document.getElementById("use_input").value;
        user = escape(user);
        const dbRef = ref(getDatabase());

        get(child(dbRef, `credentials/${user}`))
          .then((snapshot) => {
            if (snapshot.exists()) {
              var p = document.getElementById("text");
              p.innerText = "Username is taken!";
            } else {
              checkMerchant();
            }
          })
          .catch((error) => {
            console.error(error);
          });
      }

      function checkMerchant() {
        var shopname = document.getElementsByClassName("list")[0].value;
        shopname = escape(shopname);
        const dbRef = ref(getDatabase());
        get(child(dbRef, `merchants/${shopname}`))
          .then((snapshot) => {
            if (snapshot.exists()) {
              var p = document.getElementById("text");
              p.innerText = "Your business is already registered!";
            } else {
              writeUserData();
            }
          })
          .catch((error) => {
            console.error(error);
          });
      }

      function detect(URL, callback) {
        var image = new Image();
        image.src = URL;
        image.onload = function () {
          var result = true
          callback(result);
        };

        image.onerror = function () {
          var result = false
          callback(result);
        };
      }

      window.validate = function validate() {
        var p = document.getElementById("text");
        var img = document.getElementById("formFileSm");
        var desc = document.getElementById("des");
        if (desc.value.length == 0) {
          p.innerText = "Please enter a short description of your business";
          p.style.visibility = "visible";
        } else {
          if (img.value.match(/\.(jpeg|jpg|gif|png)$/) == null) {
            p.innerText = "Please include an image URL!";
            p.style.visibility = "visible";
          } else {
            
            detect(img.value, function (result) {
              if (result==true){
                if (
                document.getElementById("hint").innerText ==
                  "Password is good!" &&
                document.getElementById("check1").innerText ==
                  "Password match!" &&
                document.getElementById("use_warning").innerText ==
                  "Username is good!" &&
                document.getElementById("add").value.length != 0
              ) {
                p.innerText = "Loading...";
                // p.style.visibility="hidden";
                p.style.visibility = "visible";
                checkDuplicate();
              } else {
                p.innerText =
                  "Please ensure you filled in all details correctly";
                p.style.visibility = "visible";
              }
              }

              else{
                alert("You entered an invalid image url")
                p.innerText = "Please insert a valid image";
              p.style.visibility = "visible";
              }
            });
           

          }
        }
      };
      window.callboth = function callboth() {
        var pw = call();
        var pw2 = check();
      };

      function call() {
        var hint = document.getElementById("hint");
        var p = document.getElementById("pw").value;
        var errors = "";
        var list_of_error = [];

        if (p.length < 8) {
          list_of_error.push("8 characters");
        }

        if (p.search(/[0-9]/) == -1) {
          list_of_error.push("1 number");
        }

        if (p.search(/[A-Z]/) == -1) {
          list_of_error.push("an upper case letter");
        }

        if (p.search(/[a-z]/) == -1) {
          list_of_error.push("a lower case letter");
        }

        if (list_of_error.length == 0) {
          hint.innerHTML = `Password is good!`;
          document.getElementsByClassName("form__input")[1].style.borderColor =
            "forestgreen";
        } else {
          hint.innerHTML = `Password must contain at least : ${list_of_error}`;
          document.getElementsByClassName("form__input")[1].style.borderColor =
            "firebrick";
        }
      }

      function check() {
        var pw2 = document.getElementById("pw2").value;
        var pw = document.getElementById("pw").value;
        if (pw == pw2) {
          document.getElementById("check1").innerHTML = "Password match!";
          document.getElementsByClassName("form__input2")[0].style.borderColor =
            "forestgreen";
          document.getElementsByClassName("icon2")[0].innerText = "";
          return 0;
        } else {
          document.getElementsByClassName("icon2")[0].innerText = "";
          document.getElementById("check1").innerHTML = "Password do not match";
          document.getElementsByClassName("form__input2")[0].style.borderColor =
            "firebrick";
          return 1;
        }
      }

      window.user = function user() {
        var usewarning = document.getElementById("use_warning");
        var useinput = document.getElementById("use_input").value;
        if (useinput.length < 6) {
          usewarning.innerText = "Username must contain at least 6 letters!";
          document.getElementsByClassName("form__input")[0].style.borderColor =
            "firebrick";
        } else {
          usewarning.innerText = "Username is good!";
          document.getElementsByClassName("form__input")[0].style.borderColor =
            "forestgreen";
        }
      };
    </script>

    <script>
      function fill() {
        var input = document.getElementsByClassName("list")[0].value;
        // input  = input.replace(/[^a-zA-Z0-9+]/g, "");
        input = input
          .replace(/&/g, "")
          .replace(/</g, "")
          .replace(/@/g, "")
          .replace(/>/g, "")
          .replace(/"/g, "")
          .replace(/'/g, "")
          .replace(/#/g, "")
          .replace(/-/g, "")
          .replace(new RegExp("\\$", "g"), "")
          .replace(new RegExp("\\[", "g"), "")
          .replace(new RegExp("\\]", "g"), "")
          .replace(new RegExp("\\.", "g"), "")
          .replace(new RegExp("\\(", "g"), "")
          .replace(new RegExp("\\)", "g"), "")
          .replace(new RegExp("\\/", "g"), "");

        url =
          "https://data.gov.sg/api/action/datastore_search?resource_id=34f86c3e-a90c-4de9-a69f-afc86b7f31b6";

        axios
          .get(url, {
            params: {
              q: input,
            },
          })

          .then((response) => {
            var arr = [];
            var list = document.getElementById("shop");
            list.innerHTML = "";
            var obj = response.data.result.records;

            for (ea of obj) {
              if (arr.indexOf(ea.licensee_name + ea.premises_address) == -1) {
                arr.push(ea.licensee_name + ea.premises_address);
                var option = document.createElement("option");
                option.label = ea.premises_address;
                option.value = ea.licensee_name + " @ " + ea.premises_address;
                list.appendChild(option);
              }
            }
          })
          .catch((error) => {
            // process error object
          });
      }

      function populate(a) {
        var b = a.value;
        if (b.indexOf("@") == -1) {
          document.getElementById("add").value = "";
        } else {
          var c = b.substring(b.indexOf("@") + 2);
          document.getElementById("add").value = c;
        }
      }
    </script>
  </body>
</html>
