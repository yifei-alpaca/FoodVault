<!DOCTYPE html>
<html lang="en">
	<head>
		<script
			type="module"
			src="https://www.gstatic.com/firebasejs/9.1.2/firebase-app.js"
		></script>
		<!-- This is the API from Firebase Realtime Database -->
		<script
			type="module"
			src="https://www.gstatic.com/firebasejs/9.1.2/firebase-database.js"
		></script>

		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Document</title>
	</head>
	<body>
		<button onclick="retrieve()">Retrieve</button>

		<button onclick="retrieveMerchant()">
			Retrieve starbucks (merchant) info
		</button>

		<script type="module">
			import { initializeApp } from "https://www.gstatic.com/firebasejs/9.1.2/firebase-app.js";
			import {
				getDatabase,
				ref,
				set,
				get,
				child,
			} from " https://www.gstatic.com/firebasejs/9.1.2/firebase-database.js";
			const firebaseConfig = {
				apiKey: "AIzaSyDKC3yvnonrxiGALVjDktGoS_t8y5adUJk",
				authDomain: "foodvault-6d35a.firebaseapp.com",
				databaseURL:
					"https://foodvault-6d35a-default-rtdb.asia-southeast1.firebasedatabase.app",
				projectId: "foodvault-6d35a",
				storageBucket: "foodvault-6d35a.appspot.com",
				messagingSenderId: "863157964884",
				appId: "1:863157964884:web:02b343ccf7a6d780459dc1",
				measurementId: "G-S687X22CVW",
			};

			const app = initializeApp(firebaseConfig);
			const database = getDatabase(app);

			window.retrieve = function retrieve() {
				//retrieve all
				//add window.function to access
				const dbRef = ref(getDatabase());
				get(child(dbRef, `merchants`))
					.then((snapshot) => {
						if (snapshot.exists()) {
							console.log(snapshot.val());
						} else {
							console.log("No data available");
						}
					})
					.catch((error) => {
						console.error(error);
					});
			};

			window.retrieveMerchant = function retrieveMerchant() {
				//retrieve all
				//add window.function to access

				//replace var id value with the merchant PK
				var id =
					"STARBUCKS COFFEE SINGAPORE PTEysdot LTDysdot @ 8 SHENTON WAY yshashB1-12ysslsh13 TEMASEK TOWER SINGAPORE 068811";
				const dbRef = ref(getDatabase());
				get(child(dbRef, `merchants/` + id))
					.then((snapshot) => {
						if (snapshot.exists()) {
							console.log(snapshot.val());
						} else {
							console.log("No data available");
						}
					})
					.catch((error) => {
						console.error(error);
					});
			};
		</script>
	</body>
</html>
